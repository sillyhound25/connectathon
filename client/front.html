<!DOCTYPE html>
<html>
<head>
    <title></title>

    <script src="js/libs/jquery-1.9.0.min.js"></script>
    <script src="js/libs/handlebars-v1.3.0.js"></script>
    <script src="js/libs/underscore-min.js"></script>
    <script src="js/libs/backbone-min.js"></script>
    <script src="js/libs/moment.min.js"></script>
    <script src="js/libs/async.js"></script>
    <script src="js/libs/typeahead.bundle.js"></script>
    <script src="js/libs/sorttable.js"></script> <!-- http://www.kryogenix.org/code/browser/sorttable  -->

    <script src="js/views/queryView.js"></script>
    <script src="js/views/ValueSetListView.js"></script>
    <script src="js/views/ValueSetSummaryView.js"></script>
    <script src="js/views/ValueSetDetailView.js"></script>
    <script src="js/views/ExtensionView.js"></script>
    <script src="js/models/ValueSetModel.js"></script>


    <script src="js/views/ProfileListView.js"></script>
    <script src="js/views/ProfileDetailView.js"></script>
    <script src="js/views/ProfileExtensionView.js"></script>
    <script src="js/views/ProfileSummaryView.js"></script>
    <script src="js/views/ProfileTestFormView.js"></script>
    <script src="js/views/ProfileQueryView.js"></script>
    <script src="js/views/ProfileContentView.js"></script>
    <script src="js/views/ProfileStructureView.js"></script>
    <script src="js/models/ProfileModel.js"></script>
    <script src="js/models/ProfileSummaryModel.js"></script>
    <script src="js/models/ProfileTestFormModel.js"></script>
    <script src="js/models/ExtensionModel.js"></script>
    <script src="js/collections/ProfileCollection.js"></script>
    <script src="js/collections/ValueSetCollection.js"></script>
    <script src="js/collections/ExtensionCollection.js"></script>


    <!-- Latest compiled and minified CSS-->
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
    <!-- Optional theme-->
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap-theme.min.css">

    <link rel="stylesheet" href="css/font-awesome.min.css">
    <!-- Latest compiled and minified JavaScript -->
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>

    <style>
            /* Sortable tables */
        table.sortable thead {
            background-color:#eee;
            color:#666666;
            font-weight: bold;
            cursor: pointer;
        }
    </style>

</head>
<body style="padding: 8px">

<div id='loading' class="alert alert-warning">Loading...</div>

<nav class="navbar navbar-default" role="navigation">
    <div class="container-fluid">
        <div class="navbar-header">
            <a class="navbar-brand" href="#">
                <img src="images/icon-fhir-32.png"/>
            </a>
            <a class="navbar-brand" href="#">  FHIR Workbench</a>
        </div>
        <ul class="nav navbar-nav">
            <li class="active  navMainOption" data-page='homeTab'><a href="#"><i class="glyphicon glyphicon-home"></i> Home</a> </li>
            <li class="navMainOption" data-page='profileTab'><a href="#" ><i class="glyphicon glyphicon-file"></i> Profiles</a></li>
            <li class=" navMainOption" data-page='vsTab'><a href="#"><i class="glyphicon glyphicon-list"></i>  ValueSets</a></li>
            <li class=" navMainOption" data-page='extensionPage'><a href="#"><i class="glyphicon glyphicon-resize-full"></i>  Extensions</a></li>
            <li class="navMainOption" data-page='queryTab'><a href="#"><i class="glyphicon glyphicon-fire"></i>  Resource basedSearch</a></li>
            <li class="navMainOption" data-page='profileQueryTab'><a href="#"><i class="glyphicon glyphicon-fire"></i>  Patient based Search</a></li>
        </ul>
        <ul class="nav navbar-nav pull-right">
            <li class="navMainOption" data-page='helpTab'><a href="#" ><i class="glyphicon glyphicon-question-sign"></i> </a></li>
        </ul>
    </div>
</nav>

<div class="container-fluid">

    <div>
        <div class="myPane" id="homeTab">
            <!--<div class="bg-primary container text-center"> <h2>Orion Profile and ValueSet editor</h2></div>-->
            <p>This application allows you to view and edit the profiles and valueSets created to support the
            Orion FHIR interfaces. It is very much a sub-set of the full capability of these resources, and so cannot display
            every profile - only those generated by this tool, or that only utilize the same subset as this tool</p>

            <p>If you are new to the concept of FHIR and profiles, then there are a number of resources available</p>
            <ul>
                <li>The <a target="_blank" href='http://hl7.org/implement/standards/fhir/'>FHIR specification</a> is the definitive source of truth for FHIR</li>
                <li>There's a <a target="_blank"  href='http://vimeo.com/87074652'>video</a> by Ewout Kramer (one of the FHIR core team) on the reason for profiles</li>
                <li>David Hay has a blog on FHIR (look in the <a target="_blank" href='http://fhirblog.com/index/'>index</a> for Profile specific posts)</li>
            </ul>

            <p>Click on the help icon to the upper right for more information about the tool</p>

            <h5>Assumptions</h5>
            <ul>
                <li>The Profile extensions are only against resources (not datatypes) and only for a single resource</li>
                <li>Assume that the profiles only use ValueSets published by Orion</li>
                <li>Assume that the reference to a valueset is to an external one - no Contained sets</li>
                <li>Assume that the Orion ValueSets have a unique name property</li>
            </ul>
        </div>

        <div class="myPane" id="profileTab">
            <div class="row">
                <div class="col-md-3 wellXXX">



                    <div id="orionProfilesDiv"></div>
                </div>

                <div class="col-md-9">
                    <!--
                                        <div id="workAreaProfile"></div>-->
                    <ul class="nav nav-tabs">
                        <li class="pull-right"><a href="#profileTestDataSubTab" data-toggle="tab">Test Data</a></li>
                        <li class="pull-right"><a href="#profileContentSubTab" data-toggle="tab">Content</a></li>

                        <li class="pull-right"><a href="#profileSummarySubTab" data-toggle="tab">All Properties</a></li>
                        <li class="active pull-right"><a href="#profileDetailSubTab" data-toggle="tab">Extensions</a></li>

                    </ul>
                    <br />
                    <div class="tab-content" >

                        <div class="active tab-pane" id="profileDetailSubTab">
                            <!--<h4>Profile Detail</h4>-->
                            <div id="workAreaProfile"></div>
                        </div>

                        <div class="tab-pane" id="profileContentSubTab">
                            <!--<h4>Profile Detail</h4>-->
                            <div id="workAreaContentProfile"></div>
                        </div>

                        <div class="  tab-pane" id="profileSummarySubTab">
                            <!--<button  class="btn btn-success pull-right" id="btnCreateSummaryXXX">Generate summary</button>-->

                            <div id='updatingProfileSummaryMsg' style="display:none" class="alert alert-warning">Reading data for the summary. This can take a while...</div>

                            <div id="workAreaSummaryProfile"></div>
                        </div>

                        <div class="tab-pane" id="profileTestDataSubTab">

                            <!--<h4>Generate Test Data</h4>-->

                            <div id="workAreaTestData"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="myPane" id="vsTab">
            <div class="row">
                <div class="col-md-2 well">
                    <h4>ValueSets</h4>
                    <div id="display"></div>
                </div>
                <div class="col-md-10">
                    <h4>ValueSet Detail</h4>
                    <div id="workAreaVS"></div>
                </div>
            </div>

        </div>

        <div class="myPane" id="extensionPage">
            <div class="row">
                <div id="allExtensionsDiv"></div>
            </div>
        </div>



        <div class="myPane" id="queryTab">
            <div class="row">
                <div id="workAreaQuery"></div>


            </div>

        </div>

        <div class="myPane" id="profileQueryTab">
            <div class="row">
                <div id="workAreaProfileQuery"></div>


            </div>

        </div>



        <div class="myPane" id = "helpTab">
            <iframe id="myIFrame" style="width: 1200px; height:600px"></iframe>
        </div>

    </div>


    <div id="editExtensionDiv"></div>
    <div id="editStructureDiv"></div>
    <div id="modalDialogDiv"></div>
</div>

<script>

    $(document).ready(function(){

        //see the 'mediator.js' file for the main commands that initiate the workbench
        //at some point I'll make this a real mediator.
        //Note that it's critical that the mediator.js is the last file to be referenced (plan is to move to require.js)

        //activate the navbar tags...
        $('.myPane').hide();        //initially hide all the panes...
        //$('#homeTab').show();       //show the home tab
        $('#profileTab').show();       //show the profile tab


        //set up the help frame,,

        //$('#myIFrame').attr('src','http://wp.me/P4qCEG-3');




        //activate the tabs on the navbar
        $(".navMainOption").on('click',function(ev){
            $(".navMainOption").removeClass('active');
            $(ev.currentTarget).addClass('active');
            //show the appropriate pane...
            $('.myPane').hide();
            var paneToShow = ev.currentTarget.getAttribute('data-page')
            $('#'+paneToShow).show();
            switch (paneToShow) {
                case 'extensionPage' : {
                    Backbone.trigger("extensions:render")
                    break;
                }
            }


        })

        Handlebars.registerHelper('proper',function(str){
            return str.replace(/\w\S*/g, function(txt){return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();});
        })

    })


</script>


<script id="generalModelDlg" type="text/x-handlebars-template">
    <div class="modal fade" id="generalDlg">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title"><span id="generalDlgTitle">General Dialog</span></h4>
                </div>
                <div class="modal-body">
                    <div id='modal-content'></div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
    </div><!-- /.modal -->

</script>


<!-- Mediator must be last...-->
<script src="js/mediator.js"></script>



</body>
</html>