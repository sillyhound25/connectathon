<!DOCTYPE html>
<html>
<head>
    <title>Questionnaire</title>

    <script src="js/libs/jquery-1.9.0.min.js"></script>
    <script src="js/libs/handlebars-v1.3.0.js"></script>
    <script src="js/libs/underscore-min.js"></script>
    <script src="js/libs/backbone-min.js"></script>
    <script src="js/libs/moment.min.js"></script>

    <!--
    <script src="js/libs/async.js"></script>
    <script src="js/libs/typeahead.bundle.js"></script>
    <script src="js/libs/sorttable.js"></script> <!-- http://www.kryogenix.org/code/browser/sorttable

    <script src="js/views/queryView.js"></script>
    <script src="js/views/ValueSetListView.js"></script>
    <script src="js/views/ValueSetSummaryView.js"></script>
    <script src="js/views/ValueSetDetailView.js"></script>
    <script src="js/views/ExtensionView.js"></script>
    <script src="js/models/ValueSetModel.js"></script>


    <script src="js/views/ProfileListView.js"></script>
    <script src="js/views/ProfileDetailView.js"></script>
    <script src="js/views/ProfileExtensionView.js"></script>
    <script src="js/views/ProfileSummaryView.js"></script>
    <script src="js/views/ProfileTestFormView.js"></script>
    <script src="js/views/ProfileQueryView.js"></script>
    <script src="js/views/ProfileContentView.js"></script>
    <script src="js/views/ProfileStructureView.js"></script>
    <script src="js/models/ProfileModel.js"></script>
    <script src="js/models/ProfileSummaryModel.js"></script>
    <script src="js/models/ProfileTestFormModel.js"></script>
    <script src="js/models/ExtensionModel.js"></script>
    <script src="js/collections/ProfileCollection.js"></script>
    <script src="js/collections/ValueSetCollection.js"></script>
    <script src="js/collections/ExtensionCollection.js"></script>

    <script src="js/libs/json2xml.js"></script>

        <script src="http://chaijs.com/chai.js" type="text/javascript"></script>
    -->

    <!-- Latest compiled and minified CSS-->
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
    <!-- Optional theme-->
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap-theme.min.css">

    <link rel="stylesheet" href="css/font-awesome.min.css">
    <!-- Latest compiled and minified JavaScript -->
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>

</head>
<body>
<h1>Questionnaire</h1>

<div id="form"></div>
<script>

    var html;
    var config = {questLayout:'table'}
    $(document).ready(function(){
        var uri = '/api/oneresource/Questionnaire/ct-6';

        $.get(uri,function(Q){
            console.log(Q)
            var form = Q.group;     //the root element of the form
            var html1 = showGroup(form);
            console.log(html1);
            $('#form').html(html1);
        })
    });


    //show a group
    function showGroup(grp) {
        console.log(grp.header);

        html += "<h3>" +grp.header+ "</h3>";
        if (grp.question) {
            if (config.questLayout === 'table') {
                html += "<table class='table '>";
            }
            _.each(grp.question,function(quest){
                if (config.questLayout === 'table') {
                    html += "<tr>";
                }

                html += showQuestion(quest);

                if (config.questLayout === 'table') {
                    html += "</tr>";
                }

            })
            if (config.questLayout === 'table') {
                html += "</table>";
            }
        }

        if (grp.group) {
            _.each(grp.group,function(grp1){
                console.log('it')
                showGroup(grp1);
            })
        }
        return html;
    }

    //show a question (and possibly an answer)
    function showQuestion(quest) {
        //var lne =
        if (config.questLayout === 'table') {
            return "<td>" + quest.text + "</td>";
        } else {
            return "<p>" + quest.text + "</p>";
        }

    }


</script>



</body>
</html>